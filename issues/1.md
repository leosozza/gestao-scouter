### NOTA: Este issue está obsoleto - A arquitetura mudou

**Status**: ❌ OBSOLETO - A aplicação agora utiliza exclusivamente a tabela 'leads' do Supabase como fonte única de verdade.

**Arquitetura Atual**: TabuladorMax → Supabase (tabela 'leads') → Repository → Hook → Componente

Este issue descreve uma implementação antiga que dependia de Google Sheets. A nova arquitetura elimina essa dependência e centraliza todos os dados na tabela 'leads' do Supabase, sincronizada bidirecionalmente com TabuladorMax.

Para informações atualizadas, consulte:
- [LEADS_DATA_SOURCE.md](../LEADS_DATA_SOURCE.md) - Guia completo da arquitetura atual
- [CENTRALIZACAO_LEADS_SUMMARY.md](../CENTRALIZACAO_LEADS_SUMMARY.md) - Resumo da migração

---

## Descrição Original (Obsoleta)

### Mapa único com dados em tempo real via Supabase (Scouters cluster + Fichas heatmap)

Hoje o mapa carrega dados da tabela 'leads' do Supabase, que é sincronizada com TabuladorMax. O fluxo atual é: TabuladorMax → Supabase → Front.
* Scouters: cluster que explode no zoom e exibe nome do scouter no pino individual.
* Fichas: heatmap por densidade de fichas (vermelho = maior concentração).

## Tarefas:
* Criar/rodar migrations para scouters, scouter_locations, fichas e fichas_geo.
* Deploy das Edge Functions: sync-scouters e sync-fichas (com X-Secret).
* Configurar variáveis no Supabase: SHEETS_SYNC_SHARED_SECRET, SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY.
* Instalar Apps Script na planilha (abas Scouters e Fichas) com gatilho de 1–5 min.
* Front: criar fonte/layes do Mapbox GL:
    * scouters com cluster, cluster-count, unclustered + popup com nome.
    * fichas com heatmap configurado.
* Toggle UI para alternar entre “Scouters” e “Fichas”.
* Remover fetch de CSV do Google em produção (manter só para DEV, se necessário).

## Critérios de aceite (Atualizados):
* ✅ Dados de scouters e leads são carregados diretamente do Supabase.
* ✅ Sincronização automática com TabuladorMax funciona corretamente.
* ✅ Sem erros de CORS no console em produção.
* ✅ Logs das Functions mostram sync bem-sucedido; Supabase contém dados coerentes.

## Notas:
* Se a planilha fornecer endereços em vez de “lat,lng”, criar uma função posterior (geocode-fichas) e chave do provider.
* GIDs/abas ficam mapeados no Apps Script; qualquer mudança de aba exige apenas ajuste no GAS.